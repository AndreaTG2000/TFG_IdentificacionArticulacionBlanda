function [Y,Xf,Af] = myNeuralNetworkFunction(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Auto-generated by MATLAB, 23-May-2022 12:58:25.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 3xQ matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-3.82866;-5.29313;-5.14052];
x1_step1.gain = [0.258315165166717;0.192781118246155;0.19304218068169];
x1_step1.ymin = -1;

% Layer 1
b1 = [2.7546730805637986705;-5.2403093689052457904;-4.2796710960147690272;11.957089672513484757;3.4130508405798773985;2.6183875312750175546;-5.4179484905838464215;-6.2106152333150967948;3.6751882909684101541;3.1273577373512706501;0.94283124760156111765;6.0350588350448512998;-0.068826831596723120343;-6.6638413721506175591;1.7251506088606611833;-1.9271381800314639765;3.22883771095244132;-4.2064536269443708605;1.8027872218901572765;-0.7374128329838020024;-1.35706585216735931;-1.2825871308119582981;0.74977212337205700887;0.26372273925175554465;-0.48461539325081898211;-0.28014302933485429881;0.27431231894704144469;0.29705312874136258205;-0.48346425517584279419;0.99752626170389613325;-0.23565138483729269891;-0.57730396938217076741;-1.3201044207278771481;3.2806128514318979583;-0.79102194529070068985;1.1379827996812768021;-3.0553336914657145407;-2.9889394469597165838;-3.6612923448225744849;2.0348222005014258151;2.6113861013175720949;3.098964771430216647;-3.0046988529012601532;1.0358209826140321042;-1.9060876571421172532;4.2526514146497378377;5.0924084518639052277;-4.6453505730587183464;4.4935012434676622206;-3.7172498905181186046];
IW1_1 = [-3.1151688590224191344 -6.228511213873027863 -2.5673904908090485755;-1.5872893469341573525 3.3777334697593262014 -1.374725338144241249;0.21824510486896792072 1.1701908983438609191 -4.4883293896546687662;-12.816763387704494193 2.8839077249363263 1.7958273387214305217;-1.7735875333183952485 -3.6361200575201051421 -3.7944084847719636855;-4.6041127548588693941 -1.0785320124804520514 -3.3802934241611501953;6.5545222548610464486 -4.3431498103239469799 -3.744774776056083887;5.2586865588758886503 0.76987498076675742187 -4.385758995929495363;-3.2580468293084163811 1.0432014305083898709 4.4680120903749624972;-8.4055756707431488195 2.3052974727593906756 -2.2318705962131293319;-0.61050603577350148754 1.9707698976294583115 1.0156970176741495493;-7.2829590861118793654 4.8565182174337548915 4.207138049212896469;-0.82236219876941685225 -0.3800808609290636797 -0.79948345673062237715;11.047351756707994852 0.49341679647844288725 -9.6086032086818704556;-1.7490903128717587567 -5.8016107138112946728 1.755296996687912392;3.4487125919499734827 0.81753589538088877742 2.5000852693818038652;-2.7676918848597980016 1.0499987711102096721 4.0048942148874031588;6.0803584465896181044 1.2289307750919833406 -10.936239381139637672;0.080630307971953904533 -3.2710358096270377715 5.2539573022717558359;5.1474780669860136229 -1.7470592112840146459 1.2966048065493591679;4.2905734470287431037 -1.2357730753508719967 -0.62090215258686898281;-13.538385617911641745 -0.86621791718989371578 -0.72204554262638598328;1.527399511605502358 -7.8845531318353634376 -0.93136669200729194085;4.9546705719800314682 -0.29421942303238851624 0.12913567863028535543;-2.5593485121059069698 7.4934886993521354626 1.6173141671702335742;-1.409264290189129909 -0.64682394411692212266 -0.32595808817996607676;-0.09812576128970976197 -2.0588990622732770142 -5.5484726084855866546;-6.6360207374678381598 10.568991134844393898 -2.1994796286085005477;-4.480988993634052342 9.3765551797502659781 -7.7521887106049538474;9.8245452832854827108 0.0170461474476349302 -0.44930874598159570299;0.20007948172851822144 2.1444470911294173376 5.8387774687178923827;-2.1677639026690038726 0.36573176123366551993 -0.92080765231250794045;-0.85637801192301199471 -1.3517595161955235916 4.9057091850557839052;2.3549465815016095149 0.083049281390631668476 -12.761563746107301043;-1.6446997154267819496 7.8947248464867874063 0.8702070064860027987;11.560426227728061832 0.33905892816600247119 0.072069342195818383856;0.17958235450300669145 -0.89836845446575785967 -3.2194963905937679094;-2.3285868334945218905 -0.25747414406121416075 11.449837390462471731;-4.3914912960560918975 -2.5749500244029546181 -1.074176128586818102;2.9807674892416358148 2.0265608363591915975 -0.34747253188754612108;3.6314956481327342885 1.7155491862987568563 -0.82818224768868875518;-1.7539865604778130947 -8.5909631747928916212 -3.0948701204998472214;-4.0006781342745600938 -1.4063065108994607932 1.160883405319582895;1.1156583153251342644 0.27106832432295979718 -0.32717507697152736768;-2.7787339506391695032 -2.7246289065361573023 0.13692871378348714373;4.8956768734194842096 1.2675860171004689203 3.4870534479457884203;3.8616006137990379621 -0.80299472041796582378 1.9875576705383171117;-5.4314999705050892587 -0.047510766796280509694 -1.3474352433329341849;-0.96613082229720992355 -5.4558407441901710655 -0.096826952684316985875;-4.6089520182826113626 1.5185715863397322156 0.56775048025449326161];

% Layer 2
b2 = -0.19736022176245354709;
LW2_1 = [-0.36854012879160669147 1.8202077678229988678 0.19713808304640914604 0.05093201809542980546 0.94045652472897045548 0.5573003623259001893 -1.4122700779445345187 0.065671119944844036365 -1.0681212277069336292 -0.068976666353407253829 -1.0987328128729501042 -1.150863482815693617 4.2683292722930152863 0.024916114610476408631 -0.075851199722970399919 1.1122538407135356131 1.2634285755244449856 0.0084083738419776492962 0.055868361940208333127 0.21965949452507060879 -0.55487294404557918615 1.6645930189892446105 1.824254031102778395 -0.57980206402266309951 -0.070669551085994986028 -4.1977348786438559713 -1.6048303738532192497 0.039783298918974474567 -0.011174536668121950664 -1.5999180662654717278 -1.5563594176631088128 -1.0635383314516202446 0.056726003819032193298 -0.32255139259146192732 1.8051500822047870098 3.2980573607925545154 -0.7841030584053300112 -0.36248626133340888789 -0.54540348180394315758 3.7388035516210029741 -3.0090162317129203196 0.066733278006733745547 -1.2609419772555983119 -5.1946900267547588825 1.1291169551492747924 -0.96567894087095462741 2.3536058007933702285 -0.41953044608858303111 1.0248415741073262364 -0.18441754877040258953];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0234961498084224;
y1_step1.xoffset = -46.5611006211289;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
    X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
    Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
x = bsxfun(@minus,y,settings.ymin);
x = bsxfun(@rdivide,x,settings.gain);
x = bsxfun(@plus,x,settings.xoffset);
end
