function [Y,Xf,Af] = myNeuralNetworkFunction(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Auto-generated by MATLAB, 06-Jun-2022 22:39:59.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 3xQ matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-3.82866;-5.29313;-5.14052];
x1_step1.gain = [0.258315165166717;0.192781118246155;0.19304218068169];
x1_step1.ymin = -1;

% Layer 1
b1 = [0.016030339441494064617;0.93623171161841045596;0.025650908390924272162;0.74832279374971677477;0.0020721409126113251448;-0.53462680867430145693;0.011167019254628892874;0.014916261146478764985;1.1493449064269933846;-0.13736311786324389983;0.48056010583955305338;-0.0066646088617565461473;0.36337706411530701356;0.54717181840332995701;0.21775490184652504522;0.57670129060883823513;-0.15728419899377002467;-0.0045944569139651850187;-0.015732244174671308062;2.7551798229292918663;-0.21618241418450093172;0.98677524332834454235;0.9478519947378554189;-0.5512564460557666246;-0.0067052841009855087412;-0.69851559724923795169;-0.20972318406891704567;-0.014564608342580222591;0.0090962353148288845744;0.067231318906364051502;0.27316401387116190369;-1.7145299356244634303;1.266803155101195566;-0.93044304782381925811;0.97647046438967866067;-0.049426924321049406363;-0.32830468522365491291;0.032705033886152638789;-0.36137068740616223872;0.053125273427264370352;2.6320774815950707115;0.59319837729637170387;0.037938984027194512516;0.13971505182428795022;-0.037748522972466232173;-0.5374619922670492711;-0.0098160255812600634429;3.0605803720572497539;0.79610447220316959971;0.55997017958909245383];
IW1_1 = [-0.0078024906526933173953 0.024548800384253801482 0.030357218344098622909;-0.43330205083773842833 0.66432607094815743221 -0.80035610116510591538;-0.027505239699903996642 -0.082300914289987772698 -0.046333630239327822098;8.8867393015818016977 -0.52196123725755338985 -3.5860449786513171055;-0.00071904200897318908559 -0.036899829170925810273 -0.034375114047790686356;0.93977745604699458593 0.15974664688335105112 -3.397698842639774508;-0.0055294314753801861867 0.010700478249623125368 0.015810104434336030854;0.34425985755687033008 0.057499336311618860773 0.42656470692647152632;0.78081129777451752094 -0.51466408692734877395 1.2880000492127277045;-0.70007596098265556517 -0.27517816440296394287 -0.87526685457696007386;-0.30272674062091925462 0.38820127080102706518 -0.56349515748250178504;0.006497089882179993281 0.075623239543999146162 0.060269514880412287938;-0.090364436270024578457 -5.7315686794794986625 0.24196265194313568148;1.0599857503351362009 1.7314021560172609959 -0.2807371490467260311;-0.43834908889503176876 1.977405169959323139 -0.77681071376094923409;-0.4965997558237857934 -2.2679912529688550649 -6.7659004497228973918;-0.41058357716249044289 -6.5723941087989121712 -1.9080923132658478281;-0.0032087036034929130104 -0.043654707770543019207 -0.036774493528331203551;-0.015505212977976202612 -0.068371191843558790091 -0.068231348505404632032;5.1350692162287137066 -3.2034531728364497027 2.09269410825132951;-2.714949535364033828 -4.9700013205815123385 9.5646730290126384944;0.41577141518213139859 0.50180532055194426722 -0.12779262252666104271;-0.018058136369733544802 0.20698961892644821003 1.0625801853697649513;-4.7751190985826612589 2.8188902520070771018 1.2165693290018484429;0.0034739091403447322146 -0.016779978123229736392 -0.018456634412667396322;0.18213932945475161396 1.8148913584532968546 5.8144232223329250786;0.18755865238358152003 -0.10865310529496069458 0.24101893627332146575;0.053117846789865225121 0.10075952009397261266 0.09146888142490446072;0.012038700650911787413 0.052493204856362371546 0.060647604243558875248;-0.0040017026971093478879 -0.045328918640812870811 0.068999579217919812524;-0.57117604476147632031 -7.9951739619875610288 -2.3722918622772217745;0.12958384191791791351 4.7784107605522949669 -0.58696838650875071686;7.2407356709741215184 3.4187506596360406341 3.4426182359067607486;-1.8227631366632703891 -0.50354303058210436728 -0.40647475231148399999;6.3148458241614946473 2.290560991437899041 -2.1957576037866277652;0.055381690927089985421 0.11267711006360119075 0.089401480472518529696;-1.0250235635068003504 -0.42202095140309842103 -0.42498871791430109512;0.055541097853339577162 0.075297603337031254744 0.10357575135492294582;-0.052572879001572800362 2.8451372715714002837 1.0663524426634065634;-0.02405258392529431577 0.018004416889322721884 0.045973866256405086783;-1.3307292594788195927 -0.90861574829165681066 -0.04328067904836694485;5.1922061015641736148 -2.6155432572409083036 -0.90908228964350734636;0.38226241029990348785 6.4792999568607889671 1.823409866254550149;-0.138097491268873801 0.18696681846384091696 -0.82004388529707206157;0.01974664882319367154 -0.0011255952282745328077 -0.012868137808817573658;-0.82019153301345915086 -0.64025414941239311428 1.7548260125898091921;0.16510010008182582353 0.07931832750070805238 0.18059689327918806989;17.286426501963351399 -0.81361951177155256154 0.077944525769799322124;0.49522613662617487318 -0.57390230662495378411 -3.9813037203484680226;0.91413121054785551056 1.9045356315740111786 -0.0028836996633447536768];

% Layer 2
b2 = -0.47614099172161511442;
LW2_1 = [0.031014973978178771857 -0.72821407242394831094 -0.09835210260311606778 -0.032828508309874215865 -0.047480391102315978868 0.14316742788449679513 0.013770344836529972363 0.31113740715647036916 0.58761595654272424927 -0.71245389665889558017 -0.46443327090364233678 0.093347818839549137615 0.09681406858875918342 1.9574009123828699508 -0.30944453342802208384 0.84418243719119490098 2.0934821290866509891 -0.053563725105316262187 -0.087766394869206232343 0.024631169909280090091 -0.012006442725966924578 0.90376584450393471215 -1.2083547920770698614 -0.6229320635915260862 -0.021165252339143073718 1.4905641199682480025 0.18065000880784692905 0.13432909275468063459 0.072503368086675734627 -0.011088153784815556191 0.68105419282859969154 -0.055821729023714669604 0.098742992995505735054 -1.0122255884064708109 -0.018522600265013917237 0.14990897038716077816 1.768695999945650188 0.10803691772117374192 0.28920537248085859128 0.022623142243004802643 0.87876921587299827721 -0.65287922132454423441 2.8192663017119152791 2.2270786086854763575 0.0029888668214236580045 1.5829883668563966559 0.17179369076975467556 0.027971765843477998381 1.2903687703163770895 -1.6131072619553539216];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0234961498084224;
y1_step1.xoffset = -46.5611006211289;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
    X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
    Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
x = bsxfun(@minus,y,settings.ymin);
x = bsxfun(@rdivide,x,settings.gain);
x = bsxfun(@plus,x,settings.xoffset);
end
